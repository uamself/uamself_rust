# 字符串常用方法

## 追加(push)

在字符串尾部可以使用`push()`方法追加单个字符`char`，也可以使用`push_str()`方法追加字符串字面量。

这两个方法都是在原有的字符串上追加，并不会返回新的字符串。由于字符串追加操作要修改原来的字符串，则该字符串必须是可变的。即字符串变量必须由mut关键字修饰。

## 插入(insert)

可以使用`insert()`方法插入单个字符`char`，也可以使用`insert_str()`方法插入字符串字面量。

与`push()`方法不同，这俩方法需要传入两个参数，第一个参数是字符（串）插入位置的索引，第二个参数是要插入的字符（串）。

索引从0开始计数，如果越界则会发生错误。

由于字符串插入操作要修改原来的字符串，则该字符串必须是可变的。即字符串变量必须由mut关键字修饰。

## 连接

### 1、使用`+`或者`+=`连接字符串

使用`+`或者`+=`连接字符串，要求右边的参数必须为字符串的切片引用（*Slice*)类型。其实当调用`+`的操作符时，相当于调用了string标准库中的`add`方法。

```rust
#[inline]
fn add(mut self, other: &str) -> String {
    self.push_str(other);
    self
}
```

这里`add`方法的第二个参数是一个引用的类型。因此我们在使用`+`，必须传递切片引用类型。不能直接传递`String`类型。`+`和`+=`都是返回一个新的字符串。所以变量声明可以不需要mut关键字修饰。


### 2、使用format!连接字符串

`format!`这种方式适用于*String*和*&str*。`format!`的用法与`print!`的用法类似，在前面输入与输出已经详细介绍过了。


## 替换

如果想要把字符串中的某个字符串替换成其它的字符串，那可以使用`replace()`方法。与替换有关的方法有三个。


### 1、replace

- 该方法可适用于String和&str类型。

- `replace`方法接收两个参数，第一个参数是要被替换的字符串，第二个参数是新的字符串。

- 该方法会替换所有匹配到的字符串。

- 该方法是返回一个新的字符串，而不是操作原来的字符串。

### 2、replacen

- 该方法可适用于String和&str类型。
- `replacen`方法接收三个参数，前两个参数与`replace`方法一样，第三个参数则表示替换的个数。
- 该方法是返回一个新的字符串，而不是操作原来的字符串。

### 3、replace\_range

- 该方法仅适用于String类型。
- `replace_range`接收两个参数，第一个参数是要替换字符串的范围（*Range*），第二个参数是新的字符串。
- 该方法是直接操作原来的字符串，不会返回新的字符串。该方法需要使用mut关键字修饰。


## 删除

与字符串删除相关的方法有4个，他们分别是`pop`，`remove`，`truncate`，`clear`。这四个方法仅适用于String类型。

### pop 删除并返回字符串的最后一个字符。

该方法是直接操作原来的字符串。但是存在返回值，其返回值是一个Option<char>类型，如果字符串为空，则返回None。

### remove 删除并返回字符串中指定位置的字符

该方法是直接操作原来的字符串。但是存在返回值，其返回值是删除位置的字符串,只接收一个参数，表示该字符起始索引位置。`remove`方法是按照字节来处理字符串的，如果参数所给的位置不是合法的字符边界，则会发生错误。



经过上面的例子，也许你理解了什么叫做不合法的字符边界。看下面的代码示例，`string_remove`是一个String类型，按照上面说的规则，计算下的它的字节长度是18字节。如果要删除第一个汉字，那就传参数为0。如果想直接删除第二个汉字，则需要传参数为3。如果你传递参数为1或者2，则会出现不合法的字符边界错误。

### truncate 删除字符串中从指定位置开始到结尾的全部字符。

该方法是直接操作原来的字符串。无返回值。该方法`truncate`方法是按照字节来处理字符串的，如果参数所给的位置不是合法的字符边界，则会发生错误。

### clear

该方法是直接操作原来的字符串。调用后，删除字符串中的所有字符，相当于`truncate`方法参数为0的时候。



## 字符串的访问

在Rust中，字符串的访问要注意以下两个点：

1、由于字符串是UTF-8编码的字节序列，是可变长度编码，所以不能直接使用索引来访问字符。

2、字符串操作分为按字节处理和按字符处理两种方式。使用`bytes()`方法是按字节处理，返回字节迭代的迭代器。使用`chars()`方法是按字符处理，返回字符迭代的迭代器。

### 字符串的长度

如果通过`len()`方法获取字符串的长度，则返回的是以字节为单位的长度，即字符串中所有字符的总字节数。如果通过`chars().count()`方法获取的长度则表示字符的长度，通过此方法获取的长度就是咱们嘴上常说的字符串长度啦。

```rust
let string_length = "我正在学习Rust~";

println!("\"{}\"的字节长度 : {}", string_length, string_length.len());
println!("\"{}\"的字符长度 : {}", string_length, string_length.chars().count());
```

### 访问字符串元素

由于Rust的字符串是UTF-8编码，所以不允许直接使用索引来访问单个字符元素。那么咱们只能借助迭代器来访问。（有关迭代器的相关知识将在后续章节介绍）`bytes()`和`char()`方法分别返回字节和字符迭代器，他们中存在`nth`方法可以通过索引的形式去访问元素。该方法返回的是`Option`类型。

```rust
let string_nth = "Rust编程基础";


// 访问第5个字符
dbg!(string_nth.chars().nth(5));
// 访问第5个字节
dbg!(string_nth.bytes().nth(5));
```
